<span class="d-flex btn px-5 pt-4 fit-content">
  <mat-icon>chevron_left</mat-icon>
  <p (click)="navigateBack()">Zurück</p>
</span>

<p class="fs-2 px-5 heading-label">
  {{ this.create ? "Objective hinzufügen" : "Objective bearbeiten" }}
</p>
<div *ngIf="objectives$ | async as objective" class="form-container">
  <div class="d-flex justify-content-center w-75">
    <form (ngSubmit)="save()" [formGroup]="objectiveForm" class="d-flex flex-column fit-content">
      <div class="d-flex align-items-center justify-content-end gap-4">
        <p class="key">Team</p>
        <mat-form-field appearance="outline" class="form-field-width form-field-height">
          <mat-label>Team</mat-label>
          <mat-select [value]="objective.teamId" formControlName="teamId">
            <mat-option *ngFor="let team of teams$ | async" [value]="team.id">
              {{ team.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="d-flex align-items-center justify-content-end gap-4">
        <p class="key">Titel</p>
        <mat-form-field appearance="outline" class="form-field-width">
          <mat-label>Titel</mat-label>
          <textarea
            [value]="objective.title"
            formControlName="title"
            matInput
            data-testId="objective-form-title"
            placeholder="Titel"
            cdkTextareaAutosize
            type="text"
            class="description-textarea"
          ></textarea>
        </mat-form-field>
      </div>
      <div class="d-flex align-items-center justify-content-end gap-4">
        <p class="key">Beschreibung</p>
        <mat-form-field appearance="outline" class="form-field-width">
          <mat-label>Beschreibung</mat-label>

          <textarea
            [value]="objective.description"
            formControlName="description"
            matInput
            placeholder="Beschreibung"
            cdkTextareaAutosize
            data-testId="objective-form-description"
            type="text"
            class="description-textarea"
          ></textarea>
        </mat-form-field>
      </div>

      <div class="d-flex align-items-center justify-content-end gap-4">
        <p class="key">Besitzer</p>
        <mat-form-field appearance="outline" class="form-field-width form-field-height">
          <mat-label>Besitzer</mat-label>
          <input type="text" matInput formControlName="owner" [matAutocomplete]="auto" />
          <mat-autocomplete #auto="matAutocomplete" [displayWith]="getUserNameById.bind(this)">
            <mat-option *ngFor="let user of filteredUsers$ | async" [value]="user">
              {{ user.firstname + " " + user.lastname }}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>
      </div>

      <div class="d-flex align-items-center justify-content-end gap-4">
        <p class="key">Zyklus</p>
        <mat-form-field appearance="outline" class="form-field-width form-field-height">
          <mat-label>Zyklus</mat-label>
          <mat-select [value]="objective.quarterId" formControlName="quarterId">
            <mat-option *ngFor="let quarter of quarters$ | async" [value]="quarter.id">
              {{ quarter.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="d-flex gap-2 justify-content-end buttons">
        <button (click)="navigateBack()" class="rounded-5" color="primary" mat-stroked-button type="reset">
          Abbrechen
        </button>

        <button [disabled]="objectiveForm.invalid" class="rounded-5" color="primary" mat-raised-button type="submit">
          {{ this.create ? "Erstellen" : "Aktualisieren" }}
        </button>
      </div>
    </form>
  </div>
</div>
