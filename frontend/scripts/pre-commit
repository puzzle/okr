#!/bin/sh

gitBasePath=$(git rev-parse --show-toplevel)
addedFiles=$(git diff --cached --name-only --diff-filter=d)

echo "*****Running prettier******"
cd $gitBasePath/frontend
npm run esl-format-specific $addedFiles
npm run prettier-format $addedFiles
echo "*****Finish running prettier******"

echo "*****Running maven formatter******"
cd $gitBasePath/backend
mvn spotless:apply -DspotlessFiles=$addedFiles
echo "*****Finish running maven formatter******"

echo "*****Adding changes to git******"
cd $gitBasePath
git add $addedFiles
echo "*****Formatted files added again******"

status=$?
exit $status
