<div class="d-flex w-100 justify-content-center">
  <mat-card class="w-100 outer-cards">
    <mat-card-content>
      <div class="d-flex w-100 justify-content-center gap-3">
        <mat-card class="w-100 inner-cards">
          <mat-card-title class="fs-6">Beschreibung</mat-card-title>

          <mat-card-content>
            {{ this.keyResult.description }}
          </mat-card-content>

          <mat-card-actions align="start">
            <button
              id="edit-keyresult-button"
              mat-stroked-button
              color="primary"
              (click)="
                routeService.navigate(
                  'objective/' +
                    keyResult.objectiveId +
                    '/keyresult/edit/' +
                    keyResult.id
                )
              "
            >
              Key Result bearbeiten
            </button>
          </mat-card-actions>
        </mat-card>

        <mat-card class="w-100 inner-cards">
          <mat-card-title class="fs-6">Letzte Messung</mat-card-title>
          <mat-card-content
            *ngIf="keyResult.measure !== null; else noMeasures"
            class="matCardContent"
          >
            <div *ngIf="startEndDate$ | async as startEndDate">
              <div>
                <strong class="lastMeasureDateTitle sameElement firstElement"
                  >Datum der Messung:
                </strong>
                <p class="sameElement lastMeasureDate">
                  {{ formatDate(keyResult.measure?.measureDate!) }}
                </p>
              </div>
              <div>
                <strong
                  class="lastMeasureChangeInfoTitle sameElement firstElement"
                  >Änderungen:
                </strong>
                <p class="sameElement lastMeasureChangeInfo">
                  {{ keyResult.measure?.changeInfo }}
                </p>
              </div>
              <div>
                <strong
                  class="lastMeasureStartDateTitle sameElement firstElement"
                  >Startdatum:
                </strong>
                <p class="sameElement lastMeasureStartDate">
                  {{ formatDate(startEndDate.startDate.toString()) }}
                </p>
              </div>
              <div>
                <strong class="lastMeasureEndDateTitle sameElement firstElement"
                  >Enddatum:
                </strong>
                <p class="sameElement lastMeasureEndDate">
                  {{ formatDate(startEndDate.endDate.toString()) }}
                </p>
              </div>
            </div>
          </mat-card-content>
          <mat-card-actions align="start">
            <button
              *ngIf="keyResult.measure !== null"
              id="show-details-button"
              mat-stroked-button
              color="primary"
              (click)="routeService.navigate('keyresults/' + this.keyResult.id)"
            >
              Details anzeigen
            </button>
            <button
              id="add-measure-button"
              mat-stroked-button
              color="primary"
              (click)="
                routeService.navigate(
                  'keyresults/' + this.keyResult.id + '/measure/new'
                )
              "
            >
              Messung hinzufügen
            </button>
          </mat-card-actions>

          <ng-template #noMeasures>
            <mat-card-content data-test-marker="emptyLastMeasure">
              <p>-</p>
            </mat-card-content>
          </ng-template>
        </mat-card>
      </div>
    </mat-card-content>
  </mat-card>
</div>
