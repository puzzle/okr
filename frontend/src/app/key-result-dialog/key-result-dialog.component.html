<div mat-dialog-content class="dialog">
  <div class="d-flex justify-content-between align-items-center">
    <p class="title">Key Result {{ data.keyResult ? "bearbeiten" : "erfassen" }}</p>
    <button data-test-id="closeDrawer" mat-dialog-close mat-icon-button>
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <form (ngSubmit)="saveKeyResult()" [formGroup]="keyResultForm" class="d-flex flex-column flex-wrap container p-0">
    <div class="d-flex flex-column gap-2 col-12">
      <label for="title" class="text-black">Titel</label>
      <mat-form-field appearance="outline">
        <textarea matInput formControlName="title" cdkFocusInitial id="title" placeholder="Key Result Titel"></textarea>
        <div *ngIf="isTouchedOrDirty('title')">
          <mat-error class="fw-bold" *ngFor="let errorKey of getErrorKeysOfFormField('title')">
            {{ errorMessages[errorKey.toUpperCase()] }}
          </mat-error>
        </div>
      </mat-form-field>
    </div>

    <div>
      <app-keyresult-type
        [keyresult]="data.keyResult"
        (newKeyresultEvent)="saveEmittedData($event)"
      ></app-keyresult-type>
    </div>

    <div class="d-flex flex-column gap-2 col-12">
      <label>Owner</label>
      <input class="owner-input" formControlName="owner" />
    </div>

    <div class="d-flex flex-column gap-2 col-12">
      <label for="title" class="text-black">Beschreibung (optional)</label>
      <mat-form-field appearance="outline">
        <textarea matInput formControlName="description" placeholder="Key Result Beschreibung"></textarea>
      </mat-form-field>
      <div *ngIf="isTouchedOrDirty('description')">
        <mat-error class="fw-bold" *ngFor="let errorKey of getErrorKeysOfFormField('description')">
          {{ errorMessages[errorKey.toUpperCase()] }}
        </mat-error>
      </div>
    </div>
  </form>

  <div class="d-flex justify-content-between p-0" mat-dialog-actions>
    <span>
      <button
        [attr.data-testId]="'submit'"
        type="submit"
        (click)="saveKeyResult()"
        [disabled]="keyResultForm.invalid"
        color="primary"
        mat-flat-button
      >
        Speichern
      </button>
      <button
        *ngIf="!data.keyResult"
        [attr.data-testId]="'saveAndNew'"
        (click)="openNew()"
        mat-stroked-button
        [disabled]="keyResultForm.invalid"
      >
        Speichern & Neu
      </button>
      <button mat-button mat-dialog-close color="primary">Abbrechen</button>
    </span>
    <button
      *ngIf="this.data.keyResult"
      [attr.data-testId]="'delete'"
      mat-button
      color="primary"
      (click)="deleteKeyResult()"
    >
      Key Result l√∂schen
    </button>
  </div>
</div>
