<mat-expansion-panel
  id="expansion-panel"
  [expanded]="isSelected"
  (closed)="removeKeyResultSelection(this.keyResult.id!)"
  (opened)="addKeyResultSelection(this.keyResult.id!)"
>
  <mat-expansion-panel-header [collapsedHeight]="'auto'" [expandedHeight]="'auto'">
    <mat-panel-title class="keyresult-title">{{ this.keyResult!.title }}</mat-panel-title>
    <mat-panel-description class="d-flex flex-row">
      <div class="d-flex w-50">
        <div class="d-flex w-50 flex-column">
          <p class="keyResultOwner">{{ keyResult!.ownerFirstname }} {{ keyResult!.ownerLastname }}</p>
        </div>
        <div class="d-flex w-50">
          <p [ngClass]="formatDate() == '-' ? 'measure-null-date' : 'measure-date'">
            {{ formatDate() }}
          </p>
        </div>
      </div>

      <div class="d-flex w-50">
        <div class="w-100 flex-column" id="progressContainer">
          <span
            *ngIf="keyResult.measure; else noMeasure"
            [ngClass]="keyResult.progress === 0 ? 'h6 red-progress' : 'h6'"
            >{{ keyResult.progress }}%</span
          >
          <ng-template #noMeasure>
            <span class="h6">-</span>
          </ng-template>
          <app-progress-bar
            [value]="keyResult.progress"
            [colorLow]="'#FF1A0C'"
            [colorMiddle]="'#FFA012'"
            [colorHigh]="'#29DF0B'"
            [limitLow]="30"
            [limitHigh]="70"
          >
          </app-progress-bar>
        </div>
        <button
          (click)="redirect(menuEntry); $event.stopPropagation()"
          aria-label="Button to edit objectives"
          mat-icon-button
        >
          <img src="assets/delete-icon.svg" alt="delete-icon" class="delete-icon" />
        </button>
      </div>

      <!--      kept in because this will be needed later on when keyresult-menu gets more functionality -->
      <!--      <mat-menu #objectiveMenu="matMenu" class="matMenu" yPosition="above">-->
      <!--        <button *ngFor="let menuEntry of menuEntries" (click)="redirect(menuEntry)" mat-menu-item>-->
      <!--          <span>{{ menuEntry.displayName }}</span>-->
      <!--        </button>-->
      <!--      </mat-menu>-->
    </mat-panel-description>
  </mat-expansion-panel-header>

  <app-key-result-overview [keyResult]="keyResult"></app-key-result-overview>
</mat-expansion-panel>
